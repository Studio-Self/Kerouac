<nav class="border-b border-terminal-dim bg-terminal">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="flex h-14 justify-between items-center">
      <!-- Logo and Nav Links -->
      <div class="flex items-center">
        <div class="flex-shrink-0">
          <%= link_to dashboard_path, class: "flex items-center hover:no-underline" do %>
            <span class="text-xl font-bold text-terminal-bright">+--[</span>
            <span class="text-xl font-bold text-terminal mx-1">KEROUAC</span>
            <span class="text-xl font-bold text-terminal-bright">]--+</span>
          <% end %>
        </div>
        <div class="hidden sm:ml-8 sm:flex sm:space-x-4">
          <%= link_to "Dashboard", dashboard_path,
              class: "nav-link #{current_page?(dashboard_path) ? 'nav-link-active' : ''}" %>
          <%= link_to "Connections", connections_path,
              class: "nav-link #{request.path.start_with?('/connections') ? 'nav-link-active' : ''}" %>
        </div>
      </div>

      <!-- User Menu -->
      <div class="hidden sm:flex sm:items-center">
        <div class="relative" data-controller="dropdown">
          <button type="button"
                  class="flex items-center px-3 py-1 border border-terminal-dim text-terminal text-sm hover:border-terminal transition-colors"
                  data-action="click->dropdown#toggle"
                  data-dropdown-target="button">
            <span class="mr-2">&lt;</span>
            <span><%= current_user.email.split('@').first %></span>
            <span class="ml-2">&gt;</span>
          </button>

          <div class="hidden absolute right-0 z-10 mt-1 w-48 dropdown-menu"
               data-dropdown-target="menu">
            <div class="px-3 py-2 text-xs text-terminal-dim border-b border-terminal-dim">
              > <%= current_user.email %>
            </div>
            <%= link_to destroy_user_session_path,
                data: { turbo_method: :delete },
                class: "dropdown-item" do %>
              [ SIGN OUT ]
            <% end %>
          </div>
        </div>
      </div>

      <!-- Mobile menu button -->
      <div class="flex items-center sm:hidden">
        <button type="button"
                class="p-2 text-terminal border border-terminal-dim hover:border-terminal"
                data-controller="mobile-menu"
                data-action="click->mobile-menu#toggle">
          <span class="sr-only">Open main menu</span>
          <span class="text-lg">=</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile menu -->
  <div class="hidden sm:hidden border-t border-terminal-dim" id="mobile-menu">
    <div class="py-2">
      <%= link_to "Dashboard", dashboard_path,
          class: "block px-4 py-2 text-sm #{current_page?(dashboard_path) ? 'text-terminal border-l-2 border-terminal' : 'text-terminal-dim border-l-2 border-transparent'} hover:text-terminal" %>
      <%= link_to "Connections", connections_path,
          class: "block px-4 py-2 text-sm #{request.path.start_with?('/connections') ? 'text-terminal border-l-2 border-terminal' : 'text-terminal-dim border-l-2 border-transparent'} hover:text-terminal" %>
    </div>
    <div class="border-t border-terminal-dim py-2">
      <div class="px-4 py-2 text-xs text-terminal-dim">
        > <%= current_user.email %>
      </div>
      <%= link_to "[ SIGN OUT ]", destroy_user_session_path,
          data: { turbo_method: :delete },
          class: "block px-4 py-2 text-sm text-terminal hover:text-terminal-bright" %>
    </div>
  </div>
</nav>
